{% extends 'admin/base.html' %}

{% block title %}Médias{% endblock %}
{% block page_title %}Bibliothèque Médias{% endblock %}

{% block content %}
<div class="bg-white rounded-xl shadow-sm p-6 mb-8">
    <h2 class="text-lg font-bold text-secondary-900 mb-4">Uploader un fichier</h2>
    <form method="POST" action="{{ url_for('admin.media_upload') }}" enctype="multipart/form-data" class="flex items-end gap-4">
        <div class="flex-1">
            <label for="file" class="block text-sm font-medium text-gray-700 mb-2">Fichier</label>
            <input type="file" id="file" name="file" accept="image/*" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500">
        </div>
        <div class="w-48">
            <label for="category" class="block text-sm font-medium text-gray-700 mb-2">Catégorie</label>
            <select id="category" name="category" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500">
                <option value="general">Général</option>
                <option value="services">Services</option>
                <option value="testimonials">Témoignages</option>
                <option value="branding">Branding</option>
            </select>
        </div>
        <div class="flex-1">
            <label for="alt_text" class="block text-sm font-medium text-gray-700 mb-2">Texte alternatif</label>
            <input type="text" id="alt_text" name="alt_text" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500">
        </div>
        <button type="submit" class="bg-primary-600 text-white px-6 py-3 rounded-lg hover:bg-primary-700 transition">
            <i class="fas fa-upload mr-2"></i>Uploader
        </button>
    </form>
</div>

<div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4">
    {% for item in media %}
    <div class="bg-white rounded-xl shadow-sm overflow-hidden group relative">
        <img src="{{ item.file_path }}" alt="{{ item.alt_text }}" class="w-full h-32 object-cover">
        <div class="p-3">
            <p class="text-xs text-gray-600 truncate">{{ item.original_filename }}</p>
            <p class="text-xs text-gray-400">{{ item.category }}</p>
        </div>
        <div class="absolute inset-0 bg-black bg-opacity-50 opacity-0 group-hover:opacity-100 transition flex items-center justify-center">
            <form method="POST" action="{{ url_for('admin.media_delete', id=item.id) }}" onsubmit="return confirm('Supprimer ce fichier ?')">
                <button type="submit" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700">
                    <i class="fas fa-trash"></i>
                </button>
            </form>
        </div>
    </div>
    {% else %}
    <div class="col-span-full text-center py-12 text-gray-500">
        Aucun média uploadé
    </div>
    {% endfor %}
</div>
{% endblock %}
